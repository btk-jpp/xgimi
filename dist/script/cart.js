"use strict";!function(s){var o,c;function d(){var o=0,n=0;s(".goods-item:visible").each(function(i,t){s(t).find(".cart-checkbox input").prop("checked")&&(o+=parseInt(s(t).find(".quantity-form input").val()),n+=parseFloat(s(t).find(".b-sum strong").html()))}),s(".amount-sum").find("em").html(o),s(".totalprice").html(n.toFixed(2))}s(document).ready(function(){s("header").load("header.html"),s("footer").load("footer.html")}),s.cookie("cookiesid")&&s.cookie("cookienum")&&(o=s.cookie("cookiesid").split(","),c=s.cookie("cookienum").split(","),s.each(o,function(i,t){var n,e;n=o[i],e=c[i],s.ajax({url:"http://localhost/project/php/alldata.php",dataType:"json"}).done(function(i){s.each(i,function(i,t){var o;n==t.sid&&((o=s(".goods-item:hidden").clone(!0,!0)).find(".goods-pic").find("img").attr("src",t.url),o.find(".goods-pic").find("img").attr("sid",t.sid),o.find(".goods-d-info").find("a").html(t.title),o.find(".b-price").find("strong").html(t.price),o.find(".quantity-form").find("input").val(e),o.find(".b-sum").find("strong").html((t.price*e).toFixed(2)),o.css("display","block"),s(".item-list").append(o),d())})})})),s(".allsel").on("change",function(){s(".goods-item:visible").find(":checkbox").prop("checked",s(this).prop("checked")),s(".allsel").prop("checked",s(this).prop("checked")),d()});var i=s(".goods-item:visible").find(":checkbox");function t(i){return(parseFloat(i.parents(".goods-item").find(".b-price strong").html())*parseInt(i.parents(".goods-item").find(".quantity-form input").val())).toFixed(2)}s(".item-list").on("change",i,function(){s(".goods-item:visible").find(":checkbox").length===s(".goods-item:visible").find("input:checked").size()?s(".allsel").prop("checked",!0):s(".allsel").prop("checked",!1),d()}),s(".quantity-add").on("click",function(){var i=s(this).parents(".goods-item").find(".quantity-form input").val();i++,s(this).parents(".goods-item").find(".quantity-form input").val(i),s(this).parents(".goods-item").find(".b-sum strong").html(t(s(this))),d(),r(s(this))}),s(".quantity-down").on("click",function(){var i=s(this).parents(".goods-item").find(".quantity-form input").val();--i<1&&(i=1),s(this).parents(".goods-item").find(".quantity-form input").val(i),s(this).parents(".goods-item").find(".b-sum strong").html(t(s(this))),d(),r(s(this))}),s(".quantity-form input").on("input",function(){var i=s(this).val();/^\d+$/g.test(i)||s(this).val(1),s(this).parents(".goods-item").find(".b-sum strong").html(t(s(this))),d(),r(s(this))});var n=[],e=[];function a(){e=s.cookie("cookiesid")&&s.cookie("cookienum")?(n=s.cookie("cookiesid").split(","),s.cookie("cookienum").split(",")):(n=[],[])}function r(i){a();var t=i.parents(".goods-item").find("img").attr("sid");e[s.inArray(t,n)]=i.parents(".goods-item").find(".quantity-form input").val(),jscookie.add("cookienum",e,10)}function p(o,i){var n=-1;s.each(i,function(i,t){o===t&&(n=i)}),i.splice(n,1),e.splice(n,1),s.cookie("cookiesid",i,{expires:10,path:"/"}),s.cookie("cookienum",e,{expires:10,path:"/"})}s(".b-action a").on("click",function(){a(),window.confirm("你确定要删除吗?")&&(s(this).parents(".goods-item").remove(),p(s(this).parents(".goods-item").find("img").attr("sid"),n),d())}),s(".operation a").on("click",function(){a(),window.confirm("你确定要全部删除吗?")&&(s(".goods-item:visible").each(function(){s(this).find(":checkbox").is(":checked")&&(s(this).remove(),p(s(this).find("img").attr("sid"),n))}),d())})}(jQuery);